---
import { getCollection, type CollectionEntry } from 'astro:content';
import { ChevronLeft } from 'lucide-astro';
import PageLayout from "../../layouts/PageLayout.astro";
import ArticleSignature from "../../components/ArticleSignature.astro";
import ArticleRecommendations from "../../components/ArticleRecommendations.astro";

export async function getStaticPaths() {
  const articles = await getCollection('articles');
  return articles.map((article) => ({
    params: { slug: article.slug },
    props: article,
  }));
}

type Props = CollectionEntry<'articles'>;

const article = Astro.props;
const { Content } = await article.render();
---

<PageLayout 
  title={`${article.data.title} - Jorge Teixeira`}
  description={article.data.description}
>
  <article class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 pt-16 pb-20">
      <header class="mb-12">
        <div class="mb-4">
          <a 
            href="/articles" 
            class="inline-flex items-center text-sm text-gray-500 hover:text-gray-700 transition-colors"
          >
            <ChevronLeft size={16} class="mr-1" />
            Back to articles
          </a>
        </div>
        
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
          {article.data.title}
        </h1>
        
        <div class="flex flex-wrap items-center gap-4 text-gray-600 mb-6">
          <time datetime={article.data.publishDate.toISOString()}>
            {article.data.publishDate.toLocaleDateString('en-US', {
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            })}
          </time>
          <div class="flex flex-wrap gap-2">
            {article.data.tags.map((tag) => (
              <span class="px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded">
                {tag}
              </span>
            ))}
          </div>
        </div>
      </header>

      <div class="prose prose-lg prose-gray max-w-none 
                  prose-headings:text-gray-900 prose-headings:font-bold
                  prose-p:text-gray-700 prose-p:leading-relaxed
                  prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline
                  prose-strong:text-gray-900 prose-strong:font-semibold
                  prose-code:text-gray-900 prose-code:bg-gray-100 prose-code:px-1 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:font-mono prose-code:before:content-none prose-code:after:content-none
                  prose-pre:bg-gray-900 prose-pre:text-gray-100 prose-pre:border-0 prose-pre:rounded-lg prose-pre:p-4
                  prose-blockquote:border-l-gray-300 prose-blockquote:text-gray-600
                  prose-ul:text-gray-700 prose-ol:text-gray-700 prose-li:text-gray-700
                  prose-hr:border-gray-200
                  [&_pre_code]:bg-transparent [&_pre_code]:text-gray-100 [&_pre_code]:p-0">
        <Content />
      </div>
      
      <ArticleSignature />
      <ArticleRecommendations currentArticle={article} />
    </article>
</PageLayout>